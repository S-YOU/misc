<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="334px" preserveAspectRatio="none" style="width:820px;height:334px;" version="1.1" viewBox="0 0 820 334" width="820px" zoomAndPan="magnify"><defs><filter height="300%" id="fka5yfy1leqb1" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="393" y="24.5332">1-RTT</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="195" x2="195" y1="71.2188" y2="293.3281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="612" x2="612" y1="71.2188" y2="293.3281"/><rect fill="#FEFECE" filter="url(#fka5yfy1leqb1)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="144" y="34.6094"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="151" y="56.1426">クライアント</text><rect fill="#FEFECE" filter="url(#fka5yfy1leqb1)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="144" y="292.3281"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="151" y="313.8613">クライアント</text><rect fill="#FEFECE" filter="url(#fka5yfy1leqb1)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="582" y="34.6094"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="589" y="56.1426">サーバ</text><rect fill="#FEFECE" filter="url(#fka5yfy1leqb1)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="582" y="292.3281"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="589" y="313.8613">サーバ</text><polygon fill="#A80036" points="600,104.5703,610,108.5703,600,112.5703,604,108.5703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="195" x2="606" y1="108.5703" y2="108.5703"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="393" x="202" y="103.7139">ClientHello(KeyShare, psk_key_exchange_modes, pre_shared_key)</text><path d="M617,86.2188 L617,112.2188 L808,112.2188 L808,96.2188 L798,86.2188 L617,86.2188 " fill="#FBFB77" filter="url(#fka5yfy1leqb1)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M798,86.2188 L798,96.2188 L808,96.2188 L798,86.2188 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="623" y="104.7139">事前に渡したPSKの使用許可</text><polygon fill="#A80036" points="206,139.9219,196,143.9219,206,147.9219,202,143.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="200" x2="611" y1="143.9219" y2="143.9219"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="212" y="139.0654">ServerHello(KeyShare, pre_shared_key)</text><polygon fill="#A80036" points="206,170.2734,196,174.2734,206,178.2734,202,174.2734" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="200" x2="611" y1="174.2734" y2="174.2734"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="212" y="169.417">EncryptedExtensions</text><polygon fill="#A80036" points="206,205.625,196,209.625,206,213.625,202,209.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="200" x2="611" y1="209.625" y2="209.625"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="212" y="204.7686">Finished</text><path d="M8,187.2734 L8,213.2734 L186,213.2734 L186,197.2734 L176,187.2734 L8,187.2734 " fill="#FBFB77" filter="url(#fka5yfy1leqb1)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M176,187.2734 L176,197.2734 L186,197.2734 L176,187.2734 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="14" y="205.7686">サーバが指示したPSK仕様</text><polygon fill="#A80036" points="600,240.9766,610,244.9766,600,248.9766,604,244.9766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="195" x2="606" y1="244.9766" y2="244.9766"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="202" y="240.1201">Finished</text><polygon fill="#A80036" points="206,271.3281,196,275.3281,206,279.3281,202,275.3281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="200" x2="611" y1="275.3281" y2="275.3281"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="212" y="270.4717">Application Data</text><!--
@startuml
skinparam defaultFontName 貂ｸ繧ｴ繧ｷ繝�繧ｯ
title 1-RTT

participant "クライアント" as C
participant "サーバ" as S

C -> S: ClientHello(KeyShare, psk_key_exchange_modes, pre_shared_key)
  note right: 事前に渡したPSKの使用許可
  S -> C: ServerHello(KeyShare, pre_shared_key)
  S -> C: EncryptedExtensions
  S -> C: Finished
  note left: サーバが指示したPSK仕様
C -> S: Finished
  S -> C: Application Data

@enduml

PlantUML version 1.2018.08(Sun Jun 24 21:31:00 JST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_172-b11
Operating System: Windows 10
OS Version: 10.0
Default Encoding: MS932
Language: ja
Country: JP
--></g></svg>