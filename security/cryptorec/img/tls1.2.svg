<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="446px" preserveAspectRatio="none" style="width:355px;height:446px;" version="1.1" viewBox="0 0 355 446" width="355px" zoomAndPan="magnify"><defs><filter height="300%" id="f19hzp5v3hqgl9" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45" x="157.5" y="24.5332">TLS1.2</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="59" x2="59" y1="71.2188" y2="404.7344"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="200" x2="200" y1="71.2188" y2="404.7344"/><rect fill="#FEFECE" filter="url(#f19hzp5v3hqgl9)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="8" y="34.6094"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="15" y="56.1426">クライアント</text><rect fill="#FEFECE" filter="url(#f19hzp5v3hqgl9)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="8" y="403.7344"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="15" y="425.2676">クライアント</text><rect fill="#FEFECE" filter="url(#f19hzp5v3hqgl9)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="170" y="34.6094"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="177" y="56.1426">サーバ</text><rect fill="#FEFECE" filter="url(#f19hzp5v3hqgl9)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="170" y="403.7344"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="177" y="425.2676">サーバ</text><polygon fill="#A80036" points="188,99.5703,198,103.5703,188,107.5703,192,103.5703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="59" x2="194" y1="103.5703" y2="103.5703"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="66" y="98.7139">ClientHello</text><polygon fill="#A80036" points="70,129.9219,60,133.9219,70,137.9219,66,133.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="64" x2="199" y1="133.9219" y2="133.9219"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="76" y="129.0654">ServerHello</text><polygon fill="#A80036" points="70,160.2734,60,164.2734,70,168.2734,66,164.2734" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="64" x2="199" y1="164.2734" y2="164.2734"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="76" y="159.417">ServerCertificate</text><polygon fill="#A80036" points="70,190.625,60,194.625,70,198.625,66,194.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="64" x2="199" y1="194.625" y2="194.625"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="76" y="189.7686">ServerKeyExchange</text><polygon fill="#A80036" points="70,220.9766,60,224.9766,70,228.9766,66,224.9766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="64" x2="199" y1="224.9766" y2="224.9766"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="76" y="220.1201">ServerHelloDone</text><polygon fill="#A80036" points="188,251.3281,198,255.3281,188,259.3281,192,255.3281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="59" x2="194" y1="255.3281" y2="255.3281"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="66" y="250.4717">ClientKeyExchange</text><polygon fill="#A80036" points="188,281.6797,198,285.6797,188,289.6797,192,285.6797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="59" x2="194" y1="285.6797" y2="285.6797"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="66" y="280.8232">ChangeCipherSpec</text><polygon fill="#A80036" points="188,312.0313,198,316.0313,188,320.0313,192,316.0313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="59" x2="194" y1="316.0313" y2="316.0313"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="66" y="311.1748">Finished</text><polygon fill="#A80036" points="70,347.3828,60,351.3828,70,355.3828,66,351.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="64" x2="199" y1="351.3828" y2="351.3828"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="76" y="346.5264">ChangeCipherSpec</text><path d="M205,329.0313 L205,355.0313 L343,355.0313 L343,339.0313 L333,329.0313 L205,329.0313 " fill="#FBFB77" filter="url(#f19hzp5v3hqgl9)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M333,329.0313 L333,339.0313 L343,339.0313 L333,329.0313 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="211" y="347.5264">ここから暗号化する</text><polygon fill="#A80036" points="70,382.7344,60,386.7344,70,390.7344,66,386.7344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="64" x2="199" y1="386.7344" y2="386.7344"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="76" y="381.8779">Finished</text><!--
@startuml
skinparam defaultFontName 貂ｸ繧ｴ繧ｷ繝�繧ｯ
title TLS1.2

participant "クライアント" as C
participant "サーバ" as S

C -> S: ClientHello
  S -> C: ServerHello
  S -> C: ServerCertificate
  S -> C: ServerKeyExchange
  S -> C: ServerHelloDone
C -> S: ClientKeyExchange
C -> S: ChangeCipherSpec
C -> S: Finished
  S -> C: ChangeCipherSpec
  note right: ここから暗号化する
  S -> C: Finished

@enduml

PlantUML version 1.2018.08(Sun Jun 24 21:31:00 JST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_172-b11
Operating System: Windows 10
OS Version: 10.0
Default Encoding: MS932
Language: ja
Country: JP
--></g></svg>