<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="415px" preserveAspectRatio="none" style="width:717px;height:415px;" version="1.1" viewBox="0 0 717 415" width="717px" zoomAndPan="magnify"><defs><filter height="300%" id="f12vn0zkyznkvf" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="339.5" y="24.5332">0-RTT</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="195" x2="195" y1="71.2188" y2="374.3828"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="680" x2="680" y1="71.2188" y2="374.3828"/><rect fill="#FEFECE" filter="url(#f12vn0zkyznkvf)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="144" y="34.6094"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="151" y="56.1426">クライアント</text><rect fill="#FEFECE" filter="url(#f12vn0zkyznkvf)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="144" y="373.3828"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="151" y="394.916">クライアント</text><rect fill="#FEFECE" filter="url(#f12vn0zkyznkvf)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="650" y="34.6094"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="657" y="56.1426">サーバ</text><rect fill="#FEFECE" filter="url(#f12vn0zkyznkvf)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="650" y="373.3828"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="657" y="394.916">サーバ</text><polygon fill="#A80036" points="668,104.5703,678,108.5703,668,112.5703,672,108.5703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="195" x2="674" y1="108.5703" y2="108.5703"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="461" x="202" y="103.7139">ClientHello(early_data, KeyShare, psk_key_exchange_modes, pre_shared_key)</text><path d="M8,86.2188 L8,112.2188 L186,112.2188 L186,96.2188 L176,86.2188 L8,86.2188 " fill="#FBFB77" filter="url(#f12vn0zkyznkvf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M176,86.2188 L176,96.2188 L186,96.2188 L176,86.2188 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="14" y="104.7139">事前に取得したPSKを使用</text><polygon fill="#A80036" points="668,139.9219,678,143.9219,668,147.9219,672,143.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="195" x2="674" y1="143.9219" y2="143.9219"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="202" y="139.0654">Application Data</text><polygon fill="#A80036" points="206,170.2734,196,174.2734,206,178.2734,202,174.2734" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="200" x2="679" y1="174.2734" y2="174.2734"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="212" y="169.417">ServerHello(pre_shared_key, KeyShare)</text><polygon fill="#A80036" points="206,200.625,196,204.625,206,208.625,202,204.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="200" x2="679" y1="204.625" y2="204.625"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="212" y="199.7686">EncryptedExtensions(early_data)</text><polygon fill="#A80036" points="206,230.9766,196,234.9766,206,238.9766,202,234.9766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="200" x2="679" y1="234.9766" y2="234.9766"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="212" y="230.1201">Finished</text><polygon fill="#A80036" points="668,261.3281,678,265.3281,668,269.3281,672,265.3281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="195" x2="674" y1="265.3281" y2="265.3281"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="202" y="260.4717">EndOfEarlyData</text><polygon fill="#A80036" points="668,291.6797,678,295.6797,668,299.6797,672,295.6797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="195" x2="674" y1="295.6797" y2="295.6797"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="202" y="290.8232">Finished</text><polygon fill="#A80036" points="206,322.0313,196,326.0313,206,330.0313,202,326.0313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="200" x2="679" y1="326.0313" y2="326.0313"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="212" y="321.1748">Application Data</text><polygon fill="#A80036" points="668,352.3828,678,356.3828,668,360.3828,672,356.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="195" x2="674" y1="356.3828" y2="356.3828"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="202" y="351.5264">Application Data</text><!--
@startuml
skinparam defaultFontName 貂ｸ繧ｴ繧ｷ繝�繧ｯ
title 0-RTT

participant "クライアント" as C
participant "サーバ" as S

C -> S: ClientHello(early_data, KeyShare, psk_key_exchange_modes, pre_shared_key)
  note left: 事前に取得したPSKを使用
C -> S: Application Data
  S -> C: ServerHello(pre_shared_key, KeyShare)
  S -> C: EncryptedExtensions(early_data)
  S -> C: Finished
C -> S: EndOfEarlyData
C -> S: Finished
  S -> C: Application Data
C -> S: Application Data
@enduml

PlantUML version 1.2018.08(Sun Jun 24 21:31:00 JST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_172-b11
Operating System: Windows 10
OS Version: 10.0
Default Encoding: MS932
Language: ja
Country: JP
--></g></svg>