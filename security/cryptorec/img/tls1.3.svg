<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="486px" preserveAspectRatio="none" style="width:525px;height:486px;" version="1.1" viewBox="0 0 525 486" width="525px" zoomAndPan="magnify"><defs><filter height="300%" id="fs81tvjklns7a" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45" x="242.5" y="24.5332">TLS1.3</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="91" x2="91" y1="71.2188" y2="445.0859"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="370" x2="370" y1="71.2188" y2="445.0859"/><rect fill="#FEFECE" filter="url(#fs81tvjklns7a)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="40" y="34.6094"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="47" y="56.1426">クライアント</text><rect fill="#FEFECE" filter="url(#fs81tvjklns7a)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="40" y="444.0859"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="47" y="465.6191">クライアント</text><rect fill="#FEFECE" filter="url(#fs81tvjklns7a)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="340" y="34.6094"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="347" y="56.1426">サーバ</text><rect fill="#FEFECE" filter="url(#fs81tvjklns7a)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="340" y="444.0859"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="347" y="465.6191">サーバ</text><polygon fill="#A80036" points="358,99.5703,368,103.5703,358,107.5703,362,103.5703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="91" x2="364" y1="103.5703" y2="103.5703"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="255" x="98" y="98.7139">ClientHello(KeyShare, signature_algorithms)</text><polygon fill="#A80036" points="102,134.9219,92,138.9219,102,142.9219,98,138.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="96" x2="369" y1="138.9219" y2="138.9219"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="108" y="134.0654">ServerHello(KeyShare)</text><path d="M375,116.5703 L375,142.5703 L513,142.5703 L513,126.5703 L503,116.5703 L375,116.5703 " fill="#FBFB77" filter="url(#fs81tvjklns7a)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M503,116.5703 L503,126.5703 L513,126.5703 L503,116.5703 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="381" y="135.0654">ここから暗号化する</text><polygon fill="#A80036" points="102,170.2734,92,174.2734,102,178.2734,98,174.2734" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="96" x2="369" y1="174.2734" y2="174.2734"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="108" y="169.417">EncryptedExtensions</text><polygon fill="#A80036" points="102,200.625,92,204.625,102,208.625,98,204.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="96" x2="369" y1="204.625" y2="204.625"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="108" y="199.7686">Certificate</text><polygon fill="#A80036" points="102,230.9766,92,234.9766,102,238.9766,98,234.9766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="96" x2="369" y1="234.9766" y2="234.9766"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="108" y="230.1201">CertificateVerify</text><polygon fill="#A80036" points="102,261.3281,92,265.3281,102,269.3281,98,265.3281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="96" x2="369" y1="265.3281" y2="265.3281"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="108" y="260.4717">Finished</text><polygon fill="#A80036" points="358,291.6797,368,295.6797,358,299.6797,362,295.6797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="91" x2="364" y1="295.6797" y2="295.6797"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="98" y="290.8232">Certificate</text><polygon fill="#A80036" points="358,322.0313,368,326.0313,358,330.0313,362,326.0313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="91" x2="364" y1="326.0313" y2="326.0313"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="98" y="321.1748">CertificateVerify</text><polygon fill="#A80036" points="358,352.3828,368,356.3828,358,360.3828,362,356.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="91" x2="364" y1="356.3828" y2="356.3828"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="98" y="351.5264">Finished</text><polygon fill="#A80036" points="102,387.7344,92,391.7344,102,395.7344,98,391.7344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="96" x2="369" y1="391.7344" y2="391.7344"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="108" y="386.8779">NewSessionTicket(ticket)</text><path d="M8,369.3828 L8,395.3828 L82,395.3828 L82,379.3828 L72,369.3828 L8,369.3828 " fill="#FBFB77" filter="url(#fs81tvjklns7a)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M72,369.3828 L72,379.3828 L82,379.3828 L72,369.3828 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="53" x="14" y="387.8779">PSK取得</text><polygon fill="#A80036" points="358,423.0859,368,427.0859,358,431.0859,362,427.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="91" x2="364" y1="427.0859" y2="427.0859"/><text fill="#000000" font-family="貂ｸ繧ｴ繧ｷ繝�繧ｯ" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="98" y="422.2295">Application Data</text><!--
@startuml
skinparam defaultFontName 貂ｸ繧ｴ繧ｷ繝�繧ｯ
title TLS1.3

participant "クライアント" as C
participant "サーバ" as S

C -> S: ClientHello(KeyShare, signature_algorithms)
  S -> C: ServerHello(KeyShare)
  note right: ここから暗号化する
  S -> C: EncryptedExtensions
  S -> C: Certificate
  S -> C: CertificateVerify
  S -> C: Finished
C -> S: Certificate
C -> S: CertificateVerify
C -> S: Finished
  S -> C: NewSessionTicket(ticket)
  note left: PSK取得
C -> S: Application Data

@enduml

PlantUML version 1.2018.08(Sun Jun 24 21:31:00 JST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_172-b11
Operating System: Windows 10
OS Version: 10.0
Default Encoding: MS932
Language: ja
Country: JP
--></g></svg>