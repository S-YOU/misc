# [FACCT: FAst, Compact, and Constant-Time Discrete Gaussian Sampler over Integers](https://eprint.iacr.org/2018/1234)

## 概要
- 格子ベース暗号では離散ガウスサンプリングが必要
- 従来の実装はコンスタントタイムではないのでサイドチャネル攻撃の可能性
- 既存の定数時間アルゴリズムは速度とメモリが非効率
  - σ:離散ガウス分布の標準偏差
  - τ:テールカット係数(10~12)とするとテーブルサイズはO(τσ)
  -  ベースサンプラーを利用する
    - ずっと小さな標準偏差σ_0からサンプルを生成する
    - エキスパンダを利用してこれらのサンプルを統合してより大きなσのサンプルを生成する
    - コンボリューションのレベルをlとすると2^l回のベースサンプラーが必要

## 貢献
- 注意深く選択した多項式近似でexp(x)を高い精度で計算する
  - exp(x)を事前計算したりBernoulliサンプルを組み合わせたりしない
- バイナリサンプリングエクスパンダをコンパクトな定数時間実装にする
- Renyi発散をバイナリサンプリングに適用する
- 他の手法より効率的であることを示す
- 提案手法は標準偏差に依存しない
- 既存手法に比べてRenyi発散を畳み込みサンプリングに適用するときにベースサンプラーσ_0を小さくできる

## 準備
- $ρ_σ(x) = exp(-x^2/2σ^2)$ : 平均0、標準偏差σの(連続な)ガウス関数
- $D_σ(x) = ρ_σ(x)/\sum_{k \in Z} ρ_σ(k)$ : 離散ガウス分布
- $U(S)$ : 集合Sの一様分布
- $B_p$ : バイアスpのBernoulli分布 $Pr(X=1)=p$, $Pr(X=0) = 1-p$
- ある区間 $[-B, B]$ に制約した分布をB-boundedという
- 格子 Λ と ε ∈ $R^+$ に対して $η_ε(Λ)$ を $ρ_{1/(s \sqrt{2π})}$ $(Λ^* - \set{0})≦ ε$ となる一番小さいsとする
  - ただし $Λ^*=\set{w ∈ R^n | x w ∈ Z \text{ for all } x ∈ Λ}$.
  - $η_ε(Z) \le \sqrt{\ln(2+2/ε)/π}$

- P, QはSupp(P) = Supp(Q)となる分布
- PとQの相対誤差Δ(P|Q) = $\max_{x∈Supp(P)} (|P(x)-Q(x))|/Q(x)$
- Kullback Leibler距離KL(P|Q) = $\sum_{x∈Supp(P)} P(x)\log(P(x)/Q(x))$
- Renyi発散
  - $R_α(P|Q) = (\sum_{x∈Supp(P)} P(x)^α/Q(x)^{α-1})^{1/(α-1)}$ for $α \ge 1$
  - $R_∞(P|Q)=\max_{x∈Supp(P)}P(x)/Q(x)$
- Max-log距離 $ML(P|Q)=\max_{x∈Supp(P)}|\log P(x)-\log Q(x)|$

### 定理
$D'_σ$ を $D_σ$ のB-bounded分布とするとM個の独立なサンプルに対して

$R_∞((D'_σ)^M|(D_σ)^M)\le exp(1)$ if $B \ge σ\sqrt{2 \log(2M)}$
