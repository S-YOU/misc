% ptex2pdf -l -synctex=1 main.tex
\documentclass{jsarticle}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{amscd}
\usepackage{xypic}
\usepackage{ascmac}
\usepackage[hyphens]{url}
\usepackage{braket}
\usepackage[dvipdfmx,hiresbb,final]{graphicx}
\newcommand{\CC}{\mathbb{C}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\FF}{\mathbb{F}}
\newcommand{\PP}{\mathbb{P}}
\newcommand{\GG}{\mathbb{G}}
\newcommand{\PhiT}{\trans{\Phi}}
\newcommand{\calN}{{\cal N}}
\newcommand{\calD}{{\cal D}}
\newcommand{\calL}{{\cal L}}
\newcommand{\calQ}{{\cal Q}}
\newcommand{\calW}{{\cal W}}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\ignore}[1]{}
\newcommand{\con}{\nabla}
\newcommand{\dcon}{\con^{*}}
\newcommand{\mcon}{\overline{\con}}
\newcommand{\cris}[3]{\Gamma_{#1 #2}^{#3}}
\newcommand{\marud}[1]{\partial_{#1}}
\newcommand{\marudd}[1]{\frac{\partial}{\partial #1}}

\newcommand{\makeop}[1]{\mathop{\mathrm{#1}}\nolimits}
\newcommand{\supp}{\makeop{supp}}

\theoremstyle{definition}
\newtheorem{theorem}{定理}
\newtheorem*{theorem*}{定理}
\newtheorem{lemma}{補題}
\newtheorem*{lemma*}{補題}
\newtheorem{definition}[theorem]{定義}
\newtheorem*{definition*}{定義}

\newcommand{\mydescription}[1]{
\begin{description}
\setlength{\itemindent}{2zw}
\setlength{\leftskip}{-2zw}
\setlength{\labelsep}{1zw}
#1
\end{description}
}

\numberwithin{theorem}{section}

\begin{document}
『情報幾何学の基礎』（藤原彰夫）輪読会4章資料 by @herumi

\section{復習}
$M$を$C^\infty$多様体, $\chi(M)$を$M$のベクトル場全体とする.
\begin{definition}[Riemann多様体]
$(M,g)$がRiemann多様体であるとは任意の$p \in M$にたいして
\[
g_p : T_pM \times T_pM \rightarrow \RR\text{が内積}
\]
であって任意の$X$, $Y \in \chi(M)$にたいして
\[
g:M \ni p \mapsto g_p(X_p,Y_p)\in \RR
\]
が$C^\infty$関数であるもの. $g$を$M$のRiemann計量という.
\end{definition}

\begin{definition}[パラコンパクト]
位相空間$X$にたいして任意の開被覆が局所有限な細分を持つときパラコンパクトという.
\end{definition}

\begin{definition}[開被覆]
位相空間$X$にたいしてその部分集合の集まり$\Set{U_i}$で$X=\cup_i U_i$となるものを$X$の被覆という.
$U_i$が全て$X$の開集合のとき開被覆という.
\end{definition}

\begin{definition}[細分]
位相空間$X$の被覆$\Set{U_i}$にたいして被覆$\Set{V_j}$が細分であるとは,
任意の$j$にたいして$V_j \subset U_i$となる$i$が存在するときをいう.
\end{definition}

\begin{definition}[局所有限]
位相空間$X$の被覆$\Set{U_i}$が局所有限であるとは, 任意の$x \in X$にたいして$x$のある近傍$V$が存在して$\#\Set{i|U_i \cap V \ne \emptyset}<\infty$となるときをいう.
\end{definition}

\begin{definition}[1の分割（または分解）]
$X$上の連続関数$f:X \rightarrow \RR$にたいして$\supp{f}:=\overline{\Set{x\in X:f(x) \neq 0}}$（$\overline{A}$は$A$の閉包）を$f$の台という.

位相空間$X$の開被覆$\Set{U_i}$にたいして連続関数の集合$\Set{f_i:X \rightarrow [0,1]}$で$\Set{\supp{f_i}}$が$\Set{U_i}$の細分で
\[
\sum_i f_i=1
\]
となるとき$\Set{f_i}$を$\Set{U_i}$に従属する1の分割という.
\end{definition}

\begin{theorem}
$M$をHausdorffパラコンパクト$C^\infty$多様体とする.
このとき$M$の局所有限な開被覆$\Set{U_i}$で各$\overline{U_i}$がコンパクトなものが存在する.
さらにその$\Set{U_i}$に属する1の分割$\Set{f_i}$で各$f_i$が$C^\infty$関数であるものが存在する.
\end{theorem}

\begin{theorem}
Hausdorffパラコンパクト$C^\infty$多様体にはRiemann計量が存在する.
\end{theorem}
局所有限な開被覆とそれに属する1の分割を使って, 局所的に定義した内積を張り合わせる.


以下$M$はHausdorffパラコンパクトな$C^\infty$多様体とする.

\begin{definition}[接続]
$M$上の接続
\[
\con:\chi(M) \times \chi(M)\ni (X,Y)\mapsto \con_X Y \in \chi(M)
\]
とは次を満たす写像. $\con_X Y$を$Y$の$X$による共変微分という.
\begin{itemize}
\item[1.] $\con_X(Y+Z)=\con_X Y + \con_X Z$
\item[2.] $\con_X(fY)=(Xf)Y+f\con_X Y$ for $f \in C^\infty(M)$
\item[3.] $\con_{X+Y}Z=\con_X Z+\con_Y Z$
\item[4.] $\con_{fX}Y=f\con_X Y$
\end{itemize}
\end{definition}
（注意）$\con_1$, $\con_2$が接続のとき$\con_1+\con_2$は2番目を満たさないので接続ではない.
$(\con_1+\con_2)/2$は接続である. $\con_1-\con_2$も接続ではないが(1,2)型テンソル.

$\con_X Y=0$のとき$Y$は$X$に沿って平行という.

\begin{definition}[ねじれ率テンソル]
$M$上の接続$\con$に対して$T(X,Y)=\con_X Y-\con_Y X-[X,Y]$をねじれ率テンソルという. $T:\chi(M) \times \chi(M) \rightarrow \chi(M)$.
\end{definition}

\begin{definition}[Riemann接続]
Riemann多様体$(M,g)$にたいして次を満たす接続$\con$をRiemann接続とう.
\begin{itemize}
\item[計量的] 任意の$X$, $Y$, $Z \in \chi(M)$にたいして
\[
Xg(Y,Z)=g(\con_X Y,Z)+g(Y,\con_X Z).
\]
\item[対称的] T=0.
\end{itemize}
\end{definition}
一つ目の条件は曲線$C=\Set{p(t)}$に対して$Y$, $Z$が平行なら$\con_{\dot{p}(t)} Y=\con_{\dot{p}(t)} Z=0$なので
\[
\frac{d}{dt}g(Y,Z)=g(\con_{\dot{p}(t)} Y,Z)+g(Y,\con_{\dot{p}(t)})=0.
\]
つまり$g(Y,Z)$は不変であることを示す.

\begin{definition}[双対接続]
$(M,g)$の接続$\con$にたいして次を満たす接続$\dcon$を$g$に関する$\con$の双対affine接続という.
任意の$X$, $Y$, $Z \in \chi(M)$にたいして
\[
Xg(Y,Z)=g(\con_X Y,Z)+g(Y,\dcon_X Z).
\]
\end{definition}

\begin{theorem}
$(M,g)$の接続$\con$に対して双対接続$\dcon$は一意に存在する.
\end{theorem}

（存在）局所座標$(U_i,x^1, \dots x^n)$をとる.
\begin{eqnarray*}
& \marud{i}:=\frac{\partial}{\partial x^i}\\
& \con_{\marud{i}}\marud{j}:=\cris{i}{j}{s}\marud{s}\\
& g_{jk}:=g(\marud{j},\marud{k})\\
& \dcon_{\marud{i}}\marud{k}=:z^s_{ik}\marud{s}
\end{eqnarray*}
とする.
\begin{eqnarray*}
\marud{i}g_{jk}&=&\marud{i} g(\marud{j},\marud{k}) = g(\con_{\marud{i}}\marud{j},\marud{k})+g(\marud{j},\dcon_{\marud{i}} \marud{s})\\
&=&g(\cris{i}{j}{s}\marud{s},\marud{k})+g(\marud{j},z^s_{ik}\marud{s})=\cris{i}{j}{s}g(\marud{s},\marud{k})+z^s_{ik}g(\marud{j},\marud{s})\\
&=&\cris{i}{j}{s}g_{sk}+z^s_{ik}g_{js}.
\end{eqnarray*}
$g_{js}g^{ju}=\delta_{s}^u$より
\[
z^u_{ik}=(\marud{i}g_{jk}g^{ju}-\cris{i}{j}{s}g_{sk})g^{ju}.
\]
局所的に定義した$z^u_{ik}$で張り合わせられることを確認する（略）.

（一意性）
\begin{lemma}
$X \in \chi(M)$について任意の$Y\in\chi(M)$にたいして$g(X,Y)=0$なら$X=0$.
\end{lemma}
局所的に$X=x^i \marud{i}$, $Y=\marud{j}$として$g(X,Y)=x^i g_{ij}=0$より$x^i=0$.

別の$\tilde{\dcon}$が存在したとすると
\[
g(Y,\dcon_X Z)=Xg(Y,Z)-g(\con_X Y,Z)=g(Y,\tilde{\dcon}_X Z).
\]
よって$\dcon_X Z = \tilde{\dcon}_X Z$.

\begin{definition}[双対構造]
$(M,g,\con,\dcon)$を$M$の双対構造という.
\end{definition}
\begin{itemize}
\item $(\dcon)^{*}=\con$.
\item
\begin{eqnarray*}
\con\text{ がRiemann接続 } &\iff& Xg(Y,Z)=g(\con_X Y,Z)+g(Y,\con_X Z) \text{ かつ }T=0\\
&\iff& \dcon = \con \text{ かつ }T=0.
\end{eqnarray*}
\end{itemize}

$\con$, $\dcon$は一般には計量的とは限らない.
\begin{lemma}
$\mcon:=(\con+\dcon)/2$は計量的.
\end{lemma}
（証明）
\begin{eqnarray*}
Xg(Y,Z)&=&g(\con_X Y, Z)+g(Y, \dcon_X Z)\\
&+&\\
Xg(Z,Y)&=&g(\con_X Z, Y)+g(Z, \dcon_X Y)\\
&||&\\
2Xg(Y,Z)&=&g((\con_X+\dcon_X)Y,Z)+g(Y,(\con_X+\dcon_X)Z).
\end{eqnarray*}
よって
\[
Xg(Y,Z)=g(\mcon_X Y, Z)+g(Y, \mcon_X Z).
\]
\begin{theorem}
曲線$C=\Set{p(t)|a\leq t \leq b}$に沿った$\con$, $\dcon$に関する平行移動$\Pi_C$, $\Pi^{*}_C$について
任意の$v$, $w \in T_{p(a)}M$にたいし
\[
g_{p(b)}(\Pi_C v, \Pi^{*}_C w)=g_{p(a)}(v,w).
\]
つまり片方を$\con$に関して, もう片方を$\dcon$に関して接ベクトルを平行移動するとその内積は保存される.
\end{theorem}

（証明）$Y$, $Z$を$C$に沿って$\con$平行, $\dcon$平行なベクトル場とする.
つまり$\con_{\frac{d}{dt}}Y=\dcon_{\frac{d}{dt}}Z=0$.
よって
\[
\frac{d}{dt}g(Y,Z)=g(\con_{\frac{d}{dt}}Y,Z)+g(Y,\dcon_{\frac{d}{dt}}Z)=0.
\]
\begin{definition}[曲率]
任意の$X$, $Y \in \chi(M)$にたいして曲率$R$を$R(X,Y):=[\con_X, \con_Y] - \con_{[X,Y]}$で定義する.
\end{definition}

\begin{theorem}
$\con$曲率$R=0$である必要十分条件は$\dcon$曲率$R^{*}=0$.
\end{theorem}

（証明）
\begin{eqnarray*}
& [X,Y]g(Z,W)&=g(\con_{[X,Y]}Z,W)+g(Z,\dcon_{[X,Y]}W)\\
&||&\\
&XYg(Z,W)-YXg(Z,W)&=X(g(\con_Y Z,W)+g(Z,\dcon_Y W))
-Y(g(\con_X Z,W)+g(Z,\dcon_X W))\\
&&= g(\con_X \con_Y Z,W)+g(\con_Y Z,\dcon_X W)
+(g\con_X Z,\dcon_Y W)+g(Z,\dcon_X \dcon_Y W)\\
&&-g(\con_Y \con_X Z,W)-g(\con_X Z,\dcon_Y W)
-g(\con_Y Z,\dcon_X W)-g(Z,\dcon_Y \dcon_X W)\\
&&= g([\con_X,\con_Y]Z,W)+g(Z,[\dcon_X,\dcon_Y]W)
\end{eqnarray*}
よって
\[
g(R(X,Y,Z),W)=-g(Z,R^*(X,Y,W)).
\]
よって$R=0 \iff R^*=0$.

\begin{definition}[計量の共変微分]
\[
(\con g)(X,Y,Z):=Xg(Y,Z)-g(\con_X Y,Z)-g(Y,\con_X Z).
\]
\end{definition}
\begin{theorem}
$\con$, $\dcon$を双対な接続とすると、次のうち2条件が成り立つと残りの2条件も成り立つ.
\begin{itemize}
\item[(1)] $T_{\con}=0$.
\item[(2)] $T_{\dcon}=0$.
\item[(3)] $(\con g)(X,Y,Z)$は$X$, $Y$, $Z$について対称.
\item[(4)] $\mcon :=(\con+\dcon)/2$がRiemann接続.
\end{itemize}
\end{theorem}

（証明）
$(\con g)(X,Y,Z)$は$Y$, $Z$について対称なのは明らか.

$Xg(Y,Z)=g(\con_X Y,Z)+g(Y,\dcon_X Z)$より
\begin{eqnarray*}
(\con g)(X,Y,Z)&=&g(\con_X Y,Z)+g(Y,\dcon_X,Z)-g(\con_X Y,Z)-g(Y,\con_X Z)\\
&=&g(Y,(\dcon_X-\con_X)Z).
\end{eqnarray*}
よって
\begin{eqnarray*}
&&g(T_{\dcon}(X,Y),Z)-g(T_{\con}(X,Y),Z)=g(\dcon_X Y-\dcon_Y X-[X,Y],Z)-g(\con_X Y-\con_Y X-[X,Y],Z)\\
&=&g((\dcon_X-\con_X)Y,Z)-g((\dcon_Y-\con_Y)X,Z)\\
&=&(\con g)(X,Y,Z)-(\con g)(Y,X,Z).
\end{eqnarray*}

これにより
\begin{itemize}
\item (1), (2)が成立. $\rightarrow (\con g)(X,Y,Z)=(\con g)(Y,X,Z) \rightarrow$(3).

$\mcon$は計量的かつ
\[
T_{\mcon}=((\con_X+\dcon_X)/2) Y-((\con_Y+\dcon_Y)/2) X-[X,Y]=(T_{\con}+T_{\dcon})/2=0.
\]
よって(4)が成り立つ.

\item (1), (3)が成立. $\rightarrow g(T_{\dcon}(X,Y),Z)=(\con g)(X,Y,Z)-(\con g)(Y,X,Z)=0$.
よって$T_{\dcon}=0$で(2)が成立.

\item (2), (3)が成立. $\rightarrow -g(T_{\con}(X,Y),Z)=0 \rightarrow T_{\con}=0$.

\item (1), (4)が成立. $\rightarrow T_{\con}=T_{\mcon}=0 \rightarrow T_{\dcon}=0$で(2)が成立. よって(3)が成立.

\item (2), (4)が成立. 同様.
\item (3), (4)が成立. $\rightarrow g(T_{\dcon}(X,Y),Z)=g(T(X,Y),Z)$.
$T_{\mcon}=(T_{\con}+T_{\dcon})/2=0$より$g(T_{\con}(X,Y)+T_{\dcon}(X,Y),Z)=0$
よって$T_{\con}(X,Y)=T_{\dcon}(X,Y)=0$.
\end{itemize}
\begin{definition}[双対平坦]
双対構造をもつ多様体$(M,g,\con,\dcon)$について$T_{\con}=T_{\dcon}=0$, $R_{\con}=0$のとき$M$を双対平坦という.
\end{definition}
（注意）このとき$R_{\dcon}=0$.

$(U, x^1, \dots, x^n)$, $(V, y^1, \dots, y^n)$をそれぞれ$\con$, $\dcon$に関するaffine座標近傍とする.
affine近傍同士はaffine変換の自由度のみあった(定理3.5.2).
座標をうまくとることで次のようにできる.
\begin{theorem}
双対平坦な多様体$(M,g,\con,\dcon)$について
\[
g(\marudd{x^i}, \marudd{y^j})=\delta_{ij}
\]
となる局所$\con$ affine座標系, 局所$\dcon$ affine座標系の組$\Set{(x^i),(y^j)}$をとれる.
\end{theorem}

（証明）点$p_0 \in M$で$\con$に関するaffine座標近傍$(U,x^i)$, $\dcon$に関するaffine座標近傍$(V,\eta^j)$をとる.
つまり
\[
\con_X\left(\marudd{x^i}\right)=0, \quad \dcon_X\left(\marudd{\eta^j}\right)=0.
\]

\[
a_{ij}:=g_p((\marudd{x^i})_p, (\marudd{\eta^j})_p), \quad A:=(a_{ij})
\]
として$y^i:=\sum_j a_{ij} \eta^j$とする.
affine座標系のaffne変換なので$y^i$はaffine座標系.
\[
\marudd{\eta^j}=\sum_k a_{kj} \marudd{y^k}
\]
なので
\[
\marudd{y^k}=(A^{-1})_{jk} \marudd{\eta^j}.
\]
よって
\[
g_p(\marudd{x^i},\marudd{y^k})=(A^{-1})_{jk}g(\marudd{x^i},\marudd{\eta^j})=(A^{-1})_{jk}A_{ij}=\delta_{jk}.
\]

あとはこの座標系のまわりでも恒等的に成り立つことを確認する.
$x^i$, $y^j$がaffine座標系なので任意の$X \in \chi(M)$にたいして
\[
Xg(\marud{x^i},\marud{y^j})=g(\con_X(\marudd{x^i}),\marudd{y^j})+g(\marudd{x^i},\dcon_X(\marudd{y^j}))=0
\]
となり$g(\marud{x^i},\marud{y^j})=\delta_{jk}$が$p$の近傍で成り立つ.

以降$M:=U \cap V$とし, $\con$-affine座標系を$(\theta^i)$, $\dcon$-affine座標系を$(\eta_j)$とかく.
更に$\partial_i:=\marudd{\theta^i}$, $\partial^i:=\marudd{\eta_i}$とする.
\[
g(\partial_i,\partial^j)=\delta_i^j.
\]

\begin{lemma}
$g_{ij}:=g(\partial_i,\partial_j)$, $g^{ij}:=g(\partial^i, \partial^j)$とすると
\[
g_{ij}=\partial_i \eta_j=\partial_j \eta_i, \quad g^{ij}=\partial^i \eta^j = \partial^j \eta^i, \quad g_{ij}g^{jk}=\delta_i^k.
\]
\end{lemma}

\begin{lemma}
ある$C^\infty$関数$\Set{\psi(\theta^i,\dots,\theta^n), \varphi(\eta_i,\dots,\eta_n)}$が存在して
\[
\eta_i=\partial_i\psi, \quad \theta^i=\partial^i \varphi, \quad \psi(\theta^1, \dots, \theta^n)+\varphi(\eta_i,\dots,\eta_n)-\theta^i \eta_i=0.
\]
\end{lemma}
（注意）$y_1(x_1,x_2)$, $y_2(x_1,x_2)$があって$\frac{\partial y_1}{\partial x_2}=\frac{\partial y_2}{\partial_x1}$とする.
局所的に
\begin{eqnarray*}
y_1&=a x_1+b x_2,\\
y_2&=c x_1+d x_2
\end{eqnarray*}
と書いて条件を適用すると$b=c$.
つまり$f=\half a x_1^2+b x_1 x_2 + \half d x_2^2$とすると$y_1=\frac{\partial f}{\partial x_1}$, $y_2=\frac{\partial f}{\partial x_2}$とかける.

\begin{lemma}
$g_{ij}=\partial_i \partial_j \psi$, $g^{ij}=\partial^i \partial^j \varphi$
とかけるので$\psi$, $\varphi$は$\theta^i$, $\eta_j$に関する狭義凸関数である.
\end{lemma}

\begin{lemma}
\label{legendre}
$p \in M$について
\[
\theta(p)=(\theta^1(p), \dots, \theta^n(p)), \quad \eta(p)=(\eta_1(p), \dots, \eta_n(p))
\]
とすると
\begin{eqnarray*}
\varphi(\eta(p))&=&\max_{q\in M}(\theta^i(q) \eta_i(p)-\psi(\theta(q)))\\
\psi(\theta(p))&=&\max_{q\in M}(\eta_i(q)\theta^i(p)-\varphi(\eta(q))).
\end{eqnarray*}
\end{lemma}

（証明）$p$を固定する. 一つ目の右辺のカッコの中は第一項が$\theta^i$に関して線形で第二項は上に凸（$G$が正定値なので）.
よって微分が0ならそこは局所的に最大.

\[
d(\theta^i(q) \eta_i(p)-\psi(\theta(q)))=\eta_i(p) d \theta^i(q) - \partial_i \psi(\theta(q))d\theta^i(q)=(\eta_i(p)-\eta_i(q))d\theta^i(q)
\]
だから全ての$i$について$\eta_i(p)=\eta_i(q)$なら最大となる. それは$p=q$のときで
\[
\theta^i(p) \eta_i(p)-\psi(\theta(p))=\varphi(\eta(p)).
\]

\begin{definition}[ダイバージェンス]
双対構造$(g,\con,\dcon)$をもつ多様体$M$について$p, q \in M$にたいして
\[
D(p||q):=\psi(\theta(p))+\varphi(\eta(q))-\theta^i(p)\eta_i(q)
\]
を$\con$ダイバージェンスという.
\end{definition}

\begin{lemma}
$D(p||q)$は座標系の取り方によらない値である.

つまり$\Set{\theta^i,\eta_i}$, $\Set{\theta'^s, \eta'_t}$を$M$の双対affine座標系,
それぞれの双対ポテンシャルを$\Set{\psi(\theta),\varphi(\eta)}$, $\Set{\psi'(\theta'),\varphi'(\eta')}$とする.
このとき
\[
\psi(\theta(p))+\varphi(\eta(q))-\theta^i(p)\eta_i(q)=\psi'(\theta'(p))+\varphi'(\eta'(q))-\theta'^i(p)\eta'_i(q).
\]
\end{lemma}

（証明）affine座標系は互いにaffine変換で移りあった. つまりある$A$, $B$, $a$, $b$が存在して
\[
\theta'^s=A_i^s \theta^i+a^s, \quad \eta'_t=B^i_t \eta_i + b_t.
\]
\[
\delta_i^j=g(\marudd{\theta^i},\marudd{\eta_j})=g(A^s_i \marudd{\theta'^s},B^j_t\marudd{\eta'_j})=A^s_i B^j_t \delta^t_s=A^s_i B^j_s.
\]
よって$B=A^{-1}$.
\[
\marudd{\theta^j}(\psi'-\psi)=\frac{\partial \theta'^s}{\partial \theta^j}\frac{\partial \psi'}{\partial \theta'^s}-\eta_j=A^s_j \eta'_s-\eta_j=A^s_j (B^i_s \eta_i+b_s)-\eta_j=A^s_j b_s
\]
なので
\[
\psi'-\psi=A^s_j b_s \theta^j + c, \quad c\text{ は定数}.
\]
次に
\begin{eqnarray*}
\varphi'(\eta')-\varphi(\eta)
&=& (\theta'^s \eta'_s - \psi'(\theta')-(\theta^i \eta_i - \psi(\theta))=(A^s_i \theta^i + a^s)(B^j_s \eta_j+b_s)-\theta^i \eta_i - (\psi'(\theta')-\psi(\theta))=\\
&=& (\theta ^i \eta_j + A^s_i \theta^i b_s + a^s B^j_s \eta_j+a^s b_s)-\theta^i \eta_i-(A^s_j b_s \theta^j + c)=\\
&=& a^s B^j_s \eta_j+a^s b_s - c.
\end{eqnarray*}
最後に
\begin{eqnarray*}
&&(\psi'(\theta'(p))+\varphi'(\eta'(q))-\theta'^s(p)\eta'_s(q))-(\psi(\theta(p))+\varphi(\eta(q))-\theta^s(p)\eta_s(q))\\
&=&(A^s_j b_s \theta^j(p)+c)+(a^s B^j_s \eta_j(q)+a^s b_s-c)-(A^s_i\theta^i(p)+a^s)(B^i_s \eta_i(q)+b_s)+\theta^s(p)\eta_s(q)\\
&=&0.
\end{eqnarray*}

多様体$M$双の対構造$(g,\con,\dcon)$に対して$(g,\dcon,{\dcon}^*)$を考えると$\dcon$ダイバージェンス$D^*(p||q)$は$D(q||p)$に等しい.

補題\ref{legendre}より
\[
D(p||q)=\varphi(\eta(q))-(\theta^i(p)\eta_i(q)-\psi(\theta(p)))\geq \varphi(\eta(q))-\max_{p\in M}(\theta^i(p)\eta_i(q)-\psi(\theta(p)))=0.
\]
等号は$p=q$のときのみ成立.
ただし一般に$D(p||q)=D(q||p)$や三角不等式は成り立たない.

（Euclid空間のダイバージェンス）
$n$次元Euclid空間の座標を$(x_i)$とすると
\[
\psi(x)=\varphi(x)=\half \sum_{i=1}^n x_i^2.
\]
よって
\[
D(p||q)=\half \sum_i x_i(p)^2+ \half \sum_i x_i(q)^2-\sum_i x_i(p) x_i(q) = \half \sum_i (x_i(p)-x_i(q))^2.
\]

\begin{theorem}[一般化されたピタゴラスの定理]
双対平坦多様体$(M,g,\con,\dcon)$の3点$p$, $q$, $r$をとる.
$p$と$q$を結ぶ$\con$測地線$C_1$, $q$と$r$を結ぶ$\dcon$測地線$C_2$について$q$で$g$に関して直交しているなら
\[
D(p||q)+D(q||r)=D(p||r).
\]
\end{theorem}

（証明）
$\con$affine座標系$\theta^i$と$\dcon$affine座標系$\eta_j$をとる.
測地線は1次元の自己平行部分多様体なのでそれらの一次式で表せる.
よって
\begin{eqnarray*}
C_1&=&\Set{p(t)=(\theta^1(t), \dots, \theta^n(t))| 0 \leq t \leq 1, p(0)=q, p(1)=p},\\
\theta^i(t)&=&\theta^i(0)+(\theta^i(1)-\theta^i(0))t,\\
C_2&=&\Set{q(t)=(\eta^1(t), \dots, \eta^n(t))| 0 \leq t \leq 1, q(0)=q, q(1)=r},\\
\eta_i(t)&=&\eta_i(0)+(\eta_i(1)-\eta_i(0))t
\end{eqnarray*}
とする.
$q$で直交しているので
\begin{eqnarray*}
0&=&=g_q(\frac{dp}{dt}(0),\frac{dq}{dt}(0))=g_q((\theta^i(p)-\theta^i(q))\marudd{\theta^i},(\eta_j(r)-\eta_j(q))\marudd{\eta_j})\\
&=&(\theta^i(p)-\theta^i(q))(\eta_j(r)-\eta_j(q))\delta_i^j\\
&=&(\theta^i(p)-\theta^i(q))(\eta_i(r)-\eta_i(q)).
\end{eqnarray*}
よって
\begin{eqnarray*}
&&D(p||q)+D(q||r)-D(p||r)\\
&=&(\psi(\theta(p))+\varphi(\eta(q))-\theta^i(p)\eta_i(q))+(\psi(\theta(q))+\varphi(\eta(r))-\theta^i(q)\eta_i(r))-(\psi(\theta(p))+\varphi(\eta(r))-\theta^i(p)\eta_i(r))\\
&=&(\varphi(\eta(q))+\psi(\theta(q)))-\theta^i(p)\eta_i(q)-\theta^i(q)\eta_i(r)+\theta^i(p)\eta_i(r)\\
&=&\theta^i(q)\eta_i(q)-\theta^i(p)\eta_i(q)-\theta^i(q)\eta_i(r)+\theta^i(p)\eta_i(r)\\
&=&(\theta^i(p)-\theta^i(q))(\eta_i(r)-\eta_i(q))=0.
\end{eqnarray*}
\end{document}
